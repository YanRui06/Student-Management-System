# 学生管理系统详细说明文档

## 项目概述

这是一个基于Java和MySQL数据库的学生管理系统，采用控制台交互的方式，实现对学生信息的增删改查操作。项目使用Maven作为构建工具，适合Java初学者学习数据库操作和面向对象编程。

## 技术栈

- **编程语言**: Java 21
- **数据库**: MySQL 8.0
- **构建工具**: Maven
- **JDBC驱动**: mysql-connector-j 8.0.33

## 项目结构

```
Student-Management-System/
├── src/main/java/           # Java源代码目录
│   ├── Center.java          # 主程序入口和用户界面
│   ├── Student.java         # 学生实体类
│   ├── StudentDAO.java      # 数据访问对象，处理数据库操作
│   ├── DatabaseUtil.java    # 数据库连接工具类
│   └── ValidationUtil.java  # 数据验证工具类
├── pom.xml                  # Maven项目配置文件
├── README.md               # 项目简介
└── LICENSE                 # 项目许可证
```

## 数据库设计

### 学生表结构 (students)

| 字段名  | 数据类型     | 约束条件    | 说明       |
|---------|-------------|-------------|------------|
| id      | VARCHAR(50) | PRIMARY KEY | 学生学号   |
| name    | VARCHAR(100)| NOT NULL    | 学生姓名   |
| age     | INT         | NOT NULL    | 学生年龄   |
| address | VARCHAR(200)| NOT NULL    | 家庭住址   |

## 详细代码解析

### 1. Student.java - 学生实体类

这是一个标准的Java Bean类，用于封装学生信息。

```java
public class Student {
    // 私有成员变量，遵循封装原则
    private String ID;      // 学生学号
    private String name;    // 学生姓名  
    private int age;        // 学生年龄
    private String address; // 家庭住址
    
    // 无参构造函数 - 用于创建空的学生对象
    public Student() {
    }
    
    // 有参构造函数 - 用于创建并初始化学生对象
    public Student(String ID, String name, int age, String address) {
        this.ID = ID;           // 使用this关键字区分参数和成员变量
        this.name = name;       
        this.age = age;
        this.address = address;
    }
    
    // Getter方法 - 获取学号
    public String getID() {
        return ID;              // 返回私有变量ID的值
    }
    
    // Setter方法 - 设置学号
    public void setID(String ID) {
        this.ID = ID;           // 将参数值赋给成员变量
    }
    
    // Getter方法 - 获取姓名
    public String getName() {
        return name;
    }
    
    // Setter方法 - 设置姓名
    public void setName(String name) {
        this.name = name;
    }
    
    // Getter方法 - 获取年龄
    public int getAge() {
        return age;
    }
    
    // Setter方法 - 设置年龄
    public void setAge(int age) {
        this.age = age;
    }
    
    // Getter方法 - 获取地址
    public String getAddress() {
        return address;
    }
    
    // Setter方法 - 设置地址
    public void setAddress(String address) {
        this.address = address;
    }
    
    // 重写toString方法 - 用于打印对象信息
    @Override
    public String toString() {
        return "Student{" +         // 返回格式化的字符串
                "ID='" + ID + '\'' +        // 学号信息
                ", name='" + name + '\'' +  // 姓名信息
                ", age=" + age +            // 年龄信息
                ", address='" + address + '\'' + // 地址信息
                '}';
    }
}
```

**知识点说明：**
- **封装性**: 使用private修饰成员变量，通过public的getter/setter方法访问
- **构造函数重载**: 提供无参和有参两种构造函数
- **this关键字**: 用于区分参数和成员变量同名的情况
- **@Override注解**: 表示重写父类方法，这里重写Object类的toString方法

### 2. ValidationUtil.java - 数据验证工具类

这个工具类提供静态方法来验证用户输入的数据是否符合要求。

```java
public class ValidationUtil {
    
    // 验证年龄是否有效
    public static boolean isValidAge(int age) {
        return age > 0 && age <= 150;  // 年龄必须大于0且小于等于150
    }
    
    // 验证学号是否有效
    public static boolean isValidID(String id) {
        return id != null &&           // 学号不能为null
               !id.trim().isEmpty() && // 去除空格后不能为空字符串
               id.length() <= 50;      // 长度不能超过50个字符
    }
    
    // 验证姓名是否有效
    public static boolean isValidName(String name) {
        return name != null &&         // 姓名不能为null
               !name.trim().isEmpty() && // 去除空格后不能为空字符串
               name.length() <= 100;    // 长度不能超过100个字符
    }
    
    // 验证地址是否有效
    public static boolean isValidAddress(String address) {
        return address != null &&      // 地址不能为null
               !address.trim().isEmpty() && // 去除空格后不能为空字符串
               address.length() <= 200;     // 长度不能超过200个字符
    }
}
```

**知识点说明：**
- **静态方法**: 使用static关键字，可以直接通过类名调用，无需创建对象
- **逻辑运算符**: 使用&&进行逻辑与运算，所有条件都为true时返回true
- **字符串方法**: trim()去除首尾空格，isEmpty()判断是否为空，length()获取长度
- **数据验证**: 在数据进入数据库前进行验证，确保数据的完整性和有效性

### 3. DatabaseUtil.java - 数据库连接工具类

这个类负责管理数据库连接，提供连接的获取、关闭和测试功能。

```java
import java.sql.Connection;        // 导入数据库连接接口
import java.sql.DriverManager;     // 导入驱动管理器
import java.sql.SQLException;      // 导入SQL异常类

public class DatabaseUtil {
    // 数据库连接URL - 包含服务器地址、端口、数据库名和连接参数
    private static final String URL = "jdbc:mysql://8.138.6.70:3306/student_management?useSSL=false&allowPublicKeyRetrieval=true&serverTimezone=UTC&characterEncoding=utf8&useUnicode=true";
    
    // 数据库用户名
    private static final String USERNAME = "root";
    
    // 数据库密码
    private static final String PASSWORD = "allen-mysql";
    
    // 静态代码块 - 在类加载时执行，用于加载数据库驱动
    static {
        try {
            // 加载MySQL JDBC驱动
            Class.forName("com.mysql.cj.jdbc.Driver");
            System.out.println("MySQL JDBC驱动加载成功");
        } catch (ClassNotFoundException e) {
            // 如果驱动未找到，打印错误信息
            System.err.println("MySQL JDBC驱动未找到: " + e.getMessage());
            e.printStackTrace();  // 打印异常堆栈信息
        }
    }
    
    // 获取数据库连接
    public static Connection getConnection() throws SQLException {
        // 使用DriverManager获取数据库连接
        return DriverManager.getConnection(URL, USERNAME, PASSWORD);
    }
    
    // 关闭数据库连接
    public static void closeConnection(Connection connection) {
        if (connection != null) {       // 检查连接是否为null
            try {
                connection.close();     // 关闭连接
            } catch (SQLException e) {
                // 如果关闭失败，打印错误信息
                System.err.println("关闭数据库连接失败: " + e.getMessage());
                e.printStackTrace();
            }
        }
    }
    
    // 测试数据库连接是否正常
    public static boolean testConnection() {
        // 使用try-with-resources语句，自动关闭资源
        try (Connection conn = getConnection()) {
            System.out.println("✓ 数据库连接测试成功");
            return true;    // 连接成功返回true
        } catch (SQLException e) {
            // 连接失败，打印错误信息并返回false
            System.err.println("✗ 数据库连接测试失败: " + e.getMessage());
            return false;
        }
    }
}
```

**知识点说明：**
- **静态常量**: 使用static final声明的常量，所有实例共享
- **静态代码块**: 在类第一次被加载时执行，通常用于初始化操作
- **异常处理**: 使用try-catch捕获和处理可能发生的异常
- **try-with-resources**: Java 7新特性，自动管理资源，确保资源被正确关闭
- **JDBC URL**: 包含数据库类型、服务器地址、端口、数据库名和连接参数

### 4. StudentDAO.java - 数据访问对象

DAO（Data Access Object）模式用于封装数据库操作，提供对学生数据的CRUD操作。

```java
import java.sql.*;           // 导入所有SQL相关的类
import java.util.ArrayList;  // 导入ArrayList集合类
import java.util.List;       // 导入List接口

public class StudentDAO {
    
    // 创建学生表
    public void createTable() {
        // 使用文本块（Java 15特性）定义SQL语句
        String sql = """
            CREATE TABLE IF NOT EXISTS students (
                id VARCHAR(50) PRIMARY KEY,           -- 学号，主键
                name VARCHAR(100) NOT NULL,           -- 姓名，非空
                age INT NOT NULL,                     -- 年龄，非空
                address VARCHAR(200) NOT NULL         -- 地址，非空
            ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4   -- 设置存储引擎和字符集
            """;
        
        // 使用try-with-resources自动管理资源
        try (Connection conn = DatabaseUtil.getConnection();  // 获取数据库连接
             Statement stmt = conn.createStatement()) {       // 创建Statement对象
            
            stmt.execute(sql);  // 执行SQL语句
            System.out.println("✓ 学生表初始化成功");
        } catch (SQLException e) {
            // 捕获SQL异常并打印错误信息
            System.err.println("✗ 创建学生表失败: " + e.getMessage());
        }
    }
    
    // 添加学生
    public boolean addStudent(Student student) {
        // 使用预处理语句防止SQL注入
        String sql = "INSERT INTO students (id, name, age, address) VALUES (?, ?, ?, ?)";
        
        try (Connection conn = DatabaseUtil.getConnection();
             PreparedStatement pstmt = conn.prepareStatement(sql)) {
            
            // 设置预处理语句的参数
            pstmt.setString(1, student.getID());      // 第1个?对应学号
            pstmt.setString(2, student.getName());    // 第2个?对应姓名
            pstmt.setInt(3, student.getAge());        // 第3个?对应年龄
            pstmt.setString(4, student.getAddress()); // 第4个?对应地址
            
            int result = pstmt.executeUpdate();       // 执行更新操作
            return result > 0;                        // 如果影响行数>0，返回true
        } catch (SQLException e) {
            System.err.println("添加学生失败: " + e.getMessage());
            return false;  // 发生异常返回false
        }
    }
    
    // 删除学生
    public boolean deleteStudent(String id) {
        String sql = "DELETE FROM students WHERE id = ?";  // 根据学号删除
        
        try (Connection conn = DatabaseUtil.getConnection();
             PreparedStatement pstmt = conn.prepareStatement(sql)) {
            
            pstmt.setString(1, id);           // 设置要删除的学号
            int result = pstmt.executeUpdate(); // 执行删除操作
            return result > 0;                // 返回是否删除成功
        } catch (SQLException e) {
            System.err.println("删除学生失败: " + e.getMessage());
            return false;
        }
    }
    
    // 更新学生信息
    public boolean updateStudent(Student student) {
        // 根据学号更新其他字段
        String sql = "UPDATE students SET name = ?, age = ?, address = ? WHERE id = ?";
        
        try (Connection conn = DatabaseUtil.getConnection();
             PreparedStatement pstmt = conn.prepareStatement(sql)) {
            
            // 设置要更新的字段值
            pstmt.setString(1, student.getName());    // 新姓名
            pstmt.setInt(2, student.getAge());        // 新年龄
            pstmt.setString(3, student.getAddress()); // 新地址
            pstmt.setString(4, student.getID());      // 条件：学号
            
            int result = pstmt.executeUpdate();
            return result > 0;
        } catch (SQLException e) {
            System.err.println("更新学生信息失败: " + e.getMessage());
            return false;
        }
    }
    
    // 根据学号查找学生
    public Student findStudentById(String id) {
        String sql = "SELECT * FROM students WHERE id = ?";
        
        try (Connection conn = DatabaseUtil.getConnection();
             PreparedStatement pstmt = conn.prepareStatement(sql)) {
            
            pstmt.setString(1, id);             // 设置查询条件
            ResultSet rs = pstmt.executeQuery(); // 执行查询，返回结果集
            
            if (rs.next()) {                    // 如果有查询结果
                // 从结果集创建Student对象
                return new Student(
                    rs.getString("id"),         // 从结果集获取id字段
                    rs.getString("name"),       // 从结果集获取name字段
                    rs.getInt("age"),          // 从结果集获取age字段
                    rs.getString("address")     // 从结果集获取address字段
                );
            }
        } catch (SQLException e) {
            System.err.println("查询学生失败: " + e.getMessage());
        }
        return null;  // 未找到或发生异常返回null
    }
    
    // 获取所有学生
    public List<Student> getAllStudents() {
        List<Student> students = new ArrayList<>();  // 创建学生列表
        String sql = "SELECT * FROM students ORDER BY id";  // 按学号排序查询
        
        try (Connection conn = DatabaseUtil.getConnection();
             Statement stmt = conn.createStatement();        // 不需要参数，使用Statement
             ResultSet rs = stmt.executeQuery(sql)) {        // 执行查询
            
            while (rs.next()) {              // 遍历结果集
                // 为每一行创建Student对象
                Student student = new Student(
                    rs.getString("id"),
                    rs.getString("name"),
                    rs.getInt("age"),
                    rs.getString("address")
                );
                students.add(student);       // 添加到列表中
            }
        } catch (SQLException e) {
            System.err.println("查询所有学生失败: " + e.getMessage());
        }
        return students;  // 返回学生列表
    }
    
    // 检查学生是否存在
    public boolean checkStudentExists(String id) {
        return findStudentById(id) != null;  // 调用查找方法，检查返回值是否为null
    }
}
```

**知识点说明：**
- **DAO模式**: 数据访问对象模式，封装数据库操作逻辑
- **PreparedStatement**: 预编译的SQL语句，防止SQL注入，提高性能
- **参数占位符**: 使用?作为参数占位符，通过setXxx方法设置实际值
- **ResultSet**: 查询结果集，用于遍历查询到的数据
- **文本块**: Java 15引入的特性，用于编写多行字符串
- **资源管理**: 使用try-with-resources确保数据库连接等资源被正确关闭

### 5. Center.java - 主程序和用户界面

这是程序的主入口，提供控制台用户界面，调用各个业务方法。

```java
import java.util.List;      // 导入List接口
import java.util.Scanner;   // 导入Scanner类用于用户输入

public class Center {
    // 创建StudentDAO实例，用于数据库操作
    private static StudentDAO studentDAO = new StudentDAO();
    
    // 程序主入口
    public static void main(String[] args) {
        Scanner sc = new Scanner(System.in);  // 创建Scanner对象读取用户输入
        
        // 测试数据库连接
        if (!DatabaseUtil.testConnection()) {
            System.err.println("数据库连接失败，程序退出");
            return;  // 连接失败则退出程序
        }
        
        // 初始化数据库表
        studentDAO.createTable();
        
        // 主循环 - 显示菜单并处理用户选择
        while (true) {
            // 显示系统菜单
            System.out.println("\n========== 学生管理系统 ==========");
            System.out.println("1. 添加学生");
            System.out.println("2. 删除学生");
            System.out.println("3. 修改学生");
            System.out.println("4. 查询学生");
            System.out.println("5. 退出系统");
            System.out.println("===============================");
            System.out.print("请选择操作：");
            
            String choose = sc.next();  // 读取用户选择
            
            // 使用switch表达式（Java 14特性）处理用户选择
            switch (choose) {
                case "1" -> addStudent();      // 添加学生
                case "2" -> deleteStudent();   // 删除学生
                case "3" -> updateStudent();   // 修改学生
                case "4" -> searchStudent();   // 查询学生
                case "5" -> {
                    System.out.println("退出系统，再见！");
                    System.exit(0);            // 正常退出程序
                }
                default -> System.out.println("没有这个选项，请重新选择");
            }
        }
    }

    // 添加学生方法
    public static void addStudent() {
        Student student = new Student();        // 创建新的学生对象
        Scanner sc = new Scanner(System.in);   // 创建Scanner对象
        
        // 输入学号的循环，直到输入有效的学号
        while (true) {
            System.out.print("请输入学生ID：");
            String ID = sc.next();              // 读取学号
            
            // 验证学号格式
            if (!ValidationUtil.isValidID(ID)) {
                System.out.println("学生ID格式不正确，请重新输入");
                continue;  // 格式错误，继续循环
            }
            
            // 检查学号是否已存在
            if (studentDAO.checkStudentExists(ID)) {
                System.out.println("学生ID已存在，请重新输入");
            } else {
                student.setID(ID);  // 设置学号
                break;              // 跳出循环
            }
        }
        
        // 输入姓名的循环
        while (true) {
            System.out.print("请输入学生姓名：");
            String name = sc.next();
            
            if (ValidationUtil.isValidName(name)) {
                student.setName(name);  // 设置姓名
                break;
            } else {
                System.out.println("姓名格式不正确，请重新输入");
            }
        }
        
        // 输入年龄的循环
        while (true) {
            System.out.print("请输入学生年龄：");
            try {
                int age = sc.nextInt();  // 读取整数
                if (ValidationUtil.isValidAge(age)) {
                    student.setAge(age);  // 设置年龄
                    break;
                } else {
                    System.out.println("年龄必须在1-150之间，请重新输入");
                }
            } catch (Exception e) {
                // 捕获输入异常（如输入非数字）
                System.out.println("请输入有效的年龄数字");
                sc.nextLine();  // 清除错误输入
            }
        }
        
        // 输入地址
        sc.nextLine();  // 消费掉前面nextInt()留下的换行符
        while (true) {
            System.out.print("请输入学生家庭住址：");
            String address = sc.nextLine();  // 读取一整行（可包含空格）
            
            if (ValidationUtil.isValidAddress(address)) {
                student.setAddress(address);
                break;
            } else {
                System.out.println("地址格式不正确，请重新输入");
            }
        }
        
        // 调用DAO方法添加学生
        if (studentDAO.addStudent(student)) {
            System.out.println("✓ 添加成功");
        } else {
            System.out.println("✗ 添加失败");
        }
    }

    // 删除学生方法
    public static void deleteStudent() {
        Scanner sc = new Scanner(System.in);
        System.out.print("请输入要删除的学生ID：");
        String ID = sc.next();  // 读取要删除的学号
        
        // 先检查学生是否存在
        if (studentDAO.checkStudentExists(ID)) {
            if (studentDAO.deleteStudent(ID)) {  // 执行删除操作
                System.out.println("✓ ID为" + ID + "的学生删除成功");
            } else {
                System.out.println("✗ 删除失败");
            }
        } else {
            System.out.println("✗ 学生ID不存在");
        }
    }

    // 修改学生信息方法
    public static void updateStudent() {
        Scanner sc = new Scanner(System.in);
        System.out.print("请输入要修改学生的ID：");
        String ID = sc.next();
        
        // 根据学号查找学生
        Student student = studentDAO.findStudentById(ID);
        if (student == null) {
            System.out.println("✗ 学生不存在");
            return;  // 学生不存在，直接返回
        }
        
        // 显示当前学生信息
        System.out.println("\n当前学生信息：");
        System.out.println("ID: " + student.getID());
        System.out.println("姓名: " + student.getName());
        System.out.println("年龄: " + student.getAge());
        System.out.println("地址: " + student.getAddress());
        
        // 询问要修改的字段
        System.out.print("\n请输入您想要修改的信息(姓名/年龄/家庭地址)：");
        String info = sc.next();
        
        // 根据用户选择修改对应字段
        switch (info) {
            case "姓名":
                while (true) {
                    System.out.print("请输入新的姓名：");
                    String name = sc.next();
                    if (ValidationUtil.isValidName(name)) {
                        student.setName(name);  // 更新姓名
                        break;
                    } else {
                        System.out.println("姓名格式不正确，请重新输入");
                    }
                }
                break;
            case "年龄":
                while (true) {
                    System.out.print("请输入新的年龄：");
                    try {
                        int age = sc.nextInt();
                        if (ValidationUtil.isValidAge(age)) {
                            student.setAge(age);  // 更新年龄
                            break;
                        } else {
                            System.out.println("年龄必须在1-150之间，请重新输入");
                        }
                    } catch (Exception e) {
                        System.out.println("请输入有效的年龄数字");
                        sc.nextLine();  // 清除错误输入
                    }
                }
                break;
            case "家庭地址":
                sc.nextLine();  // 消费换行符
                while (true) {
                    System.out.print("请输入新的家庭地址：");
                    String address = sc.nextLine();
                    if (ValidationUtil.isValidAddress(address)) {
                        student.setAddress(address);  // 更新地址
                        break;
                    } else {
                        System.out.println("地址格式不正确，请重新输入");
                    }
                }
                break;
            default:
                System.out.println("✗ 无效的修改选项");
                return;  // 无效选项，直接返回
        }
        
        // 执行更新操作
        if (studentDAO.updateStudent(student)) {
            System.out.println("✓ 修改成功");
        } else {
            System.out.println("✗ 修改失败");
        }
    }

    // 查询所有学生方法
    public static void searchStudent() {
        List<Student> students = studentDAO.getAllStudents();  // 获取所有学生
        
        if (students.isEmpty()) {  // 检查是否有学生数据
            System.out.println("当前无学生数据");
            return;
        }
        
        // 显示表头
        System.out.println("\n=================== 学生信息列表 ===================");
        // 使用printf格式化输出表头
        System.out.printf("%-15s %-10s %-5s %-20s%n", "学生ID", "姓名", "年龄", "家庭地址");
        System.out.println("---------------------------------------------------");
        
        // 遍历学生列表，格式化输出每个学生的信息
        for (Student student : students) {
            System.out.printf("%-15s %-10s %-5d %-20s%n", 
                student.getID(),     // 学号，左对齐，宽度15
                student.getName(),   // 姓名，左对齐，宽度10
                student.getAge(),    // 年龄，左对齐，宽度5
                student.getAddress() // 地址，左对齐，宽度20
            );
        }
        System.out.println("===================================================");
        System.out.println("共找到 " + students.size() + " 条学生记录");
    }
}
```

**知识点说明：**
- **主方法**: public static void main(String[] args)是Java程序的入口点
- **控制台输入**: 使用Scanner类读取用户输入
- **循环控制**: 使用while(true)创建无限循环，用break跳出
- **异常处理**: 使用try-catch处理输入异常
- **字符串处理**: nextLine()读取整行，next()读取单词
- **格式化输出**: 使用printf方法格式化输出表格
- **集合操作**: 使用List集合存储多个学生对象
- **增强for循环**: for (Student student : students)遍历集合

## 运行说明

### 1. 环境准备

1. **安装Java 21**
2. **安装MySQL 8.0**
3. **创建数据库**:
   ```sql
   CREATE DATABASE student_management CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
   ```
4. **修改数据库连接信息**（在DatabaseUtil.java中）

### 2. 编译运行

```bash
# 使用Maven编译和运行
mvn compile exec:java

# 或者分步执行
mvn compile
mvn exec:java
```

### 3. 功能演示

1. **添加学生**: 输入学号、姓名、年龄、地址
2. **删除学生**: 根据学号删除学生信息
3. **修改学生**: 选择要修改的字段并输入新值
4. **查询学生**: 显示所有学生信息的表格
5. **退出系统**: 正常退出程序

## 学习要点

### 1. 面向对象编程
- 封装：Student类的私有属性和公共方法
- 单一职责：每个类都有明确的职责
- 代码复用：工具类的静态方法

### 2. 数据库编程
- JDBC连接管理
- SQL语句编写
- 预处理语句使用
- 异常处理

### 3. 用户界面设计
- 菜单驱动程序
- 输入验证
- 错误处理
- 用户友好的提示信息

### 4. 软件工程实践
- 分层架构设计
- 工具类的使用
- 异常处理策略
- 代码注释和文档

## 扩展建议

1. **添加更多验证规则**：如学号格式、姓名长度等
2. **实现数据导入导出**：支持CSV或Excel格式
3. **添加查询功能**：按姓名、年龄范围查询
4. **实现图形界面**：使用Swing或JavaFX
5. **添加日志功能**：记录操作历史
6. **实现数据备份**：定期备份数据库
7. **添加单元测试**：使用JUnit进行测试

这个项目是学习Java数据库编程的绝佳案例，涵盖了面向对象编程、数据库操作、异常处理等重要概念。通过实践这个项目，可以深入理解Java编程的核心概念和数据库应用开发的基本流程。
